openapi: 3.0.3
info:
  title: PriceDrop API
 
  version: 1.0.0
  description: |
    ## Real-time product tracking for e-commerce storefronts

    PriceDrop API lets you monitor product pricing across supported marketplaces, surface
    actionable insights, and trigger notifications when a price drops below your target.

    * üîç Product search powered by the eBay Finding API
    * üì¶ Detailed product enrichment with demand and seller insights
    * üìä Historical pricing analytics and significant-drop detection
    * üîî Configurable price-drop alerts delivered by email or webhook
    * ü§ñ Automated cron job for scheduled price checks

    Most endpoints require RapidAPI authentication headers. Public discovery endpoints are
    marked explicitly in each operation description.
  termsOfService: https://pricedrop-api.vercel.app/terms
  contact:
    name: PriceDrop API Support
    email: support@pricedrop-api.com
    url: https://pricedrop-api.vercel.app/support
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
    - url: https://pricedrop-api.vercel.app
      description: Production (direct)
    - url: https://pricedrop-api.p.rapidapi.com
      description: RapidAPI Gateway
    - url: https://pricedrop-api-staging.vercel.app
      description: Staging

tags:
  - name: Discovery
    description: Public endpoints that describe the service or supported stores.
  - name: Core
    description: Platform health, status and automation utilities.
  - name: Products
    description: Product lookup, tracking and comparison workflows.
  - name: Prices
    description: Price history analytics and scheduled checks.
  - name: Alerts
    description: CRUD operations for price drop alerts.
  - name: Affiliate
    description: Affiliate helper utilities.
components:
  securitySchemes:
    RapidAPIKey:
      type: apiKey
      in: header
      name: X-RapidAPI-Key
      description: RapidAPI subscription key.
    RapidAPIHost:
      type: apiKey
      in: header
      name: X-RapidAPI-Host
      description: RapidAPI host header (pricedrop-api.p.rapidapi.com).
    CronBearer:
      type: http
      scheme: bearer
      bearerFormat: UUID
      description: Cron secret used when invoking the scheduled price check endpoint.
  schemas:
    ApiOverview:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "üõçÔ∏è PriceDropAPI v1.0 - Real-time Price Tracking"
        version:
          type: string
          example: 1.0.0
        status:
          type: string
          example: operational
        timestamp:
          type: string
          format: date-time
        rapidapi:
          type: object
          properties:
            available:
              type: boolean
            subscribe:
              type: string
              format: uri
            documentation:
              type: string
              format: uri
            authentication:
              type: string
        endpoints:
          type: object
          additionalProperties:
            type: object
            properties:
              url:
                type: string
              method:
                type: string
              description:
                type: string
              requires_auth:
                type: boolean
        supported_stores:
          type: array
          items:
            type: string
        rate_limits:
          type: object
          additionalProperties:
            type: string
        quick_start:
          type: object
          additionalProperties:
            type: string
        support:
          type: object
          properties:
            email:
              type: string
              format: email
            documentation:
              type: string
              format: uri
            issues:
              type: string
              format: uri
    Store:
      type: object
      properties:
        domain:
          type: string
          example: ebay.com
        name:
          type: string
          example: eBay US
        currency:
          type: string
          example: USD
        supported_features:
          type: object
          properties:
            price_tracking:
              type: boolean
            image_extraction:
              type: boolean
            availability_check:
              type: boolean
            real_time_pricing:
              type: boolean
    StoresResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            stores:
              type: array
              items:
                $ref: '#/components/schemas/Store'
            total:
              type: integer
              example: 3
            last_updated:
              type: string
              format: date-time
        meta:
          type: object
          properties:
            total_supported:
              type: integer
            categories:
              type: array
              items:
                type: string
            regions:
              type: array
              items:
                type: string
    HealthResponse:
      type: object
      properties:
        success:
          type: boolean
        status:
          type: string
          enum: [healthy, degraded]
        timestamp:
          type: string
          format: date-time
        version:
          type: string
        service:
          type: string
        checks:
          type: object
          additionalProperties:
            type: string
        uptime:
          type: object
          properties:
            seconds:
              type: number
            formatted:
              type: string
        resources:
          type: object
          properties:
            memory:
              type: object
              properties:
                used:
                  type: string
                total:
                  type: string
            cpu:
              type: object
              description: Node.js `process.cpuUsage()` output.
        rapidapi:
          type: object
          properties:
            headers_detected:
              type: object
              properties:
                X-RapidAPI-Key:
                  type: boolean
                X-RapidAPI-Host:
                  type: boolean
            cors_enabled:
              type: boolean
            auth_not_required:
              type: boolean
            note:
              type: string
    StatusResponse:
      type: object
      properties:
        success:
          type: boolean
        service:
          type: string
        version:
          type: string
        status:
          type: string
        services:
          type: object
          additionalProperties:
            type: object
            properties:
              status:
                type: string
              response_time:
                type: string
              last_check:
                type: string
              note:
                type: string
              checks_per_hour:
                type: integer
              queue_size:
                type: integer
        metrics:
          type: object
          properties:
            api_calls_today:
              type: integer
            products_tracked:
              type: integer
            price_checks_performed:
              type: integer
            alerts_triggered:
              type: integer
            active_users:
              type: integer
        limits:
          type: object
          properties:
            rate_limit:
              type: string
            max_tracked_products:
              type: integer
            max_alerts:
              type: integer
            data_retention:
              type: string
        recent_issues:
          type: array
          items:
            type: string
        timestamp:
          type: string
          format: date-time
    Price:
      type: object
      properties:
        current:
          type: number
          format: float
        currency:
          type: string
        shipping:
          type: number
          format: float
    Seller:
      type: object
      properties:
        username:
          type: string
        feedback:
          type: integer
        positive:
          type: string
    ProductSummary:
      type: object
      properties:
        id:
          type: string
        title:
          type: string
        price:
          $ref: '#/components/schemas/Price'
        url:
          type: string
          format: uri
        image:
          type: string
          format: uri
        condition:
          type: string
        seller:
          type: object
        listing:
          type: object
    ProductSearchResponse:
      type: object
      properties:
        success:
          type: boolean
        query:
          type: object
          properties:
            keywords:
              type: string
            limit:
              type: integer
            sortBy:
              type: string
        count:
          type: integer
        items:
          type: array
          items:
            $ref: '#/components/schemas/ProductSummary'
    ProductInsights:
      type: object
      properties:
        price_competitiveness:
          type: string
        demand_level:
          type: object
        seller_reliability:
          type: object
        best_time_to_buy:
          type: object
    ProductDetailsResponse:
      type: object
      properties:
        success:
          type: boolean
        product:
          type: object
          properties:
            id:
              type: string
            title:
              type: string
            url:
              type: string
              format: uri
            price:
              type: object
            quantity:
              type: object
            seller:
              type: object
            insights:
              $ref: '#/components/schemas/ProductInsights'
            affiliate_links:
              type: object
              properties:
                ebay:
                  type: string
                  format: uri
                comparison:
                  type: string
            related_endpoints:
              type: object
              properties:
                track:
                  type: string
                history:
                  type: string
                similar:
                  type: string
        timestamp:
          type: string
          format: date-time
    TrackRequest:
      type: object
      required:
        - url
      properties:
        url:
          type: string
          format: uri
        target_price:
          type: number
          format: float
        notify_on_drop:
          type: boolean
          default: true
        email:
          type: string
          format: email
        webhook_url:
          type: string
          format: uri
        check_frequency:
          type: string
          example: 1h
    TrackResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        data:
          type: object
          properties:
            tracking_id:
              type: string
            product:
              type: object
              properties:
                url:
                  type: string
                  format: uri
                store:
                  type: string
                title:
                  type: string
                sku:
                  type: string
                current_price:
                  type: number
                  format: float
                original_price:
                  type: number
                  format: float
                currency:
                  type: string
                discount:
                  type: number
                  format: float
                in_stock:
                  type: boolean
                image_url:
                  type: string
                  format: uri
                rating:
                  type: number
                  format: float
                review_count:
                  type: integer
            tracking_config:
              type: object
              properties:
                target_price:
                  type: number
                notify_on_drop:
                  type: boolean
                check_frequency:
                  type: string
                notification_channels:
                  type: object
                  properties:
                    email:
                      type: boolean
                    webhook:
                      type: boolean
                    api:
                      type: boolean
            insights:
              type: object
              properties:
                price_status:
                  type: string
                recommendation:
                  type: string
                savings:
                  type: object
                  nullable: true
                price_trend:
                  type: string
            meta:
              type: object
              properties:
                created_at:
                  type: string
                  format: date-time
                last_checked:
                  type: string
                  format: date-time
                next_check:
                  type: string
                price_history_url:
                  type: string
    CompareRequest:
      type: object
      required:
        - product
      properties:
        product:
          type: string
          description: Product name or keywords.
        limit:
          type: integer
          minimum: 1
          maximum: 20
          default: 5
    CompareResponse:
      type: object
      properties:
        success:
          type: boolean
        product:
          type: object
          properties:
            query:
              type: string
            limit:
              type: integer
            marketplace:
              type: string
        comparison:
          type: object
          properties:
            ebay:
              type: object
            amazon:
              type: object
        timestamp:
          type: string
          format: date-time
    PriceHistoryResponse:
      type: object
      properties:
        success:
          type: boolean
        query:
          type: object
          properties:
            product_id:
              type: string
              nullable: true
            tracking_id:
              type: string
              nullable: true
            days:
              type: integer
            interval:
              type: string
        statistics:
          type: object
          properties:
            current_price:
              type: number
            lowest_price:
              type: number
            highest_price:
              type: number
            average_price:
              type: number
            price_range:
              type: number
            trend:
              type: string
            volatility:
              type: string
        significant_drops:
          type: array
          items:
            type: object
            properties:
              date:
                type: string
                format: date-time
              from:
                type: number
              to:
                type: number
              drop:
                type: string
              percent:
                type: string
        history:
          type: array
          items:
            type: object
            properties:
              price:
                type: number
              timestamp:
                type: string
                format: date-time
              available:
                type: boolean
        chart_data:
          type: object
          properties:
            labels:
              type: array
              items:
                type: string
            values:
              type: array
              items:
                type: number
        recommendations:
          type: object
          properties:
            buy_now:
              type: boolean
            wait:
              type: boolean
            target_price:
              type: string
        timestamp:
          type: string
          format: date-time
    Alert:
      type: object
      properties:
        id:
          type: string
        user_id:
          type: string
        product_id:
          type: string
          nullable: true
        product_url:
          type: string
          nullable: true
        target_price:
          type: number
        alert_type:
          type: string
        notification_channels:
          type: array
          items:
            type: string
        email:
          type: string
          nullable: true
        webhook_url:
          type: string
          nullable: true
        status:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
          nullable: true
        triggered:
          type: boolean
        sent:
          type: boolean
        trigger_count:
          type: integer
    AlertCreateRequest:
      type: object
      required:
        - target_price
      properties:
        product_id:
          type: string
        product_url:
          type: string
        target_price:
          type: number
        alert_type:
          type: string
          default: price_drop
        notification_channels:
          type: array
          items:
            type: string
        email:
          type: string
        webhook_url:
          type: string
    AlertsResponse:
      type: object
      properties:
        success:
          type: boolean
        count:
          type: integer
        alerts:
          type: array
          items:
            $ref: '#/components/schemas/Alert'
        summary:
          type: object
          properties:
            total:
              type: integer
            active:
              type: integer
            triggered:
              type: integer
    AlertMutationResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        alert:
          $ref: '#/components/schemas/Alert'
    AffiliateGenerateRequest:
      type: object
      required:
        - urls
      properties:
        urls:
          type: array
          minItems: 1
          items:
            type: string
            format: uri
        platform:
          type: string
          description: Optional hint for the platform (e.g. "amazon").
    AffiliateGenerateResponse:
      type: object
      properties:
        success:
          type: boolean
        links:
          type: array
          items:
            type: object
            properties:
              original:
                type: string
              affiliate:
                type: string
                nullable: true
              platform:
                type: string
              error:
                type: string
                nullable: true
        timestamp:
          type: string
          format: date-time
    CronCheckResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        results:
          type: object
          properties:
            checked:
              type: integer
            updated:
              type: integer
            alerts:
              type: integer
            errors:
              type: array
              items:
                type: object
        next_run:
          type: string
          format: date-time

paths:
  /api:
    get:
      tags:
        - Discovery
      summary: Get API overview
      description: Public discovery endpoint that outlines available endpoints, rate limits, and support resources.
      operationId: getApiOverview
      responses:
        '200':
          description: API overview payload
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiOverview'
  /api/stores:
    get:
      tags:
        - Discovery
      summary: List supported storefronts
      description: Public endpoint returning metadata for every storefront supported by the scraper configuration.
      operationId: listStores
      responses:
        '200':
          description: Supported stores
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StoresResponse'
  /api/v1/core/health:
    get:
      tags:
        - Core
      summary: Get service health
      description: Returns dependency status, uptime, and RapidAPI header detection. Authentication is skipped to simplify health monitoring.
      operationId: getCoreHealth
      responses:
        '200':
          description: Health payload
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
  /api/v1/core/status:
    get:
      tags:
        - Core
      summary: Get service status and metrics
      description: Returns aggregate service metrics and subsystem status. Requires RapidAPI headers in production deployments.
      operationId: getCoreStatus
      security:
        - RapidAPIKey: []
          RapidAPIHost: []
      responses:
        '200':
          description: Status payload
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusResponse'
  /api/v1/products/search:
    get:
      tags:
        - Products
      summary: Search products on eBay
      description: Search the eBay marketplace using keywords and optional price filters. Requires RapidAPI authentication.
      operationId: searchProducts
      security:
        - RapidAPIKey: []
          RapidAPIHost: []
      parameters:
        - name: keywords
          in: query
          required: true
          schema:
            type: string
          description: Search phrase to match titles or descriptions.
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: minPrice
          in: query
          schema:
            type: number
        - name: maxPrice
          in: query
          schema:
            type: number
        - name: sortBy
          in: query
          schema:
            type: string
            enum: [relevance, price, newest]
            default: relevance
      responses:
        '200':
          description: Search results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductSearchResponse'
        '400':
          description: Missing keywords
          content:
            application/json:
              schema:
                type: object
                properties:
                    success:
                    type: boolean
                    error:
                    type: string
                    code:
                    type: string
        '502':
          description: Upstream search failure
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  error:
                    type: string
                    message:
                    type: string
  /api/v1/products/{id}:
    get:
      tags:
        - Products
      summary: Get enriched product details
      description: Retrieve details for a specific eBay listing, including pricing insights, seller reliability, and related endpoints. Requires RapidAPI authentication.
      operationId: getProductDetails
      security:
        - RapidAPIKey: []
          RapidAPIHost: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
          description: eBay item identifier (numeric string).
      responses:
        '200':
          description: Product details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductDetailsResponse'
        '400':
          description: Missing product ID
        '404':
          description: Product not found
        '500':
          description: Unexpected error
  /api/v1/products/track:
    post:
      tags:
        - Products
      summary: Start tracking a product
      description: Creates or updates a tracked product record, stores the latest price, and optionally triggers price-drop notifications immediately if the threshold is met.
      operationId: trackProduct
      security:
        - RapidAPIKey: []
          RapidAPIHost: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TrackRequest'
            examples:
              ebay:
                summary: Track an eBay listing
                value:
                  url: https://www.ebay.com/itm/1234567890
                  target_price: 299.99
                  notify_on_drop: true
                  email: shopper@example.com
                  webhook_url: https://example.com/webhooks/price-drop
                  check_frequency: 1h
      responses:
        '201':
          description: Tracking created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TrackResponse'
        '400':
          description: Validation error or unsupported store
        '405':
          description: Method not allowed
        '500':
          description: Tracking failure
  /api/v1/products/compare:
    post:
      tags:
        - Products
      summary: Compare marketplace pricing
      description: Performs an eBay search and returns pricing insights plus an Amazon placeholder recommendation.
      operationId: compareProducts
      security:
        - RapidAPIKey: []
          RapidAPIHost: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CompareRequest'
            examples:
              console:
                summary: Compare gaming console prices
                value:
                  product: PlayStation 5 console
                  limit: 5
      responses:
        '200':
          description: Comparison payload
          content:
            application/json:
              schema:
          $ref: '#/components/schemas/CompareResponse'
        '400':
            description: Missing product query
        '500':
            description: Comparison failure
  /api/v1/prices/history:

  /v1/products/{id}:
    get:
      tags:
        - Prices
      summary: Retrieve price history analytics
      description: Returns generated or persisted price history with statistics and recommendations. Requires RapidAPI authentication.
      operationId: getPriceHistory
      security:
        - RapidAPIKey: []
          RapidAPIHost: []
      parameters:
         - name: product_id
           in: query
           schema:
           type: string
           description: Product identifier to fetch history for.
         - name: tracking_id
           in: query
           schema:
           type: string
           description: Tracking identifier returned by the tracking endpoint.
         - name: days
           in: query
           schema:
           type: integer
           minimum: 1
           maximum: 365
           default: 30
         - name: interval
           in: query
           schema:
           type: string 
           enum: [daily, hourly, weekly]
           default: daily
      responses:
        '200':
          description: Price history payload
          content:
            application/json:
              schema:
            $ref: '#/components/schemas/PriceHistoryResponse'
        '400':
         description: Missing identifiers
        '500':
          description: Unable to generate history
  /api/v1/prices/alerts:
    get:
      tags:
        - Alerts
      summary: List alerts for the authenticated user
      description: Retrieves alerts filtered by status or trigger state. Requires RapidAPI authentication and a user context provided by the RapidAPI marketplace integration.
      operationId: listAlerts
      security:
        - RapidAPIKey: []
          RapidAPIHost: []
      parameters:
        - name: status
          in: query
          schema:
          type: string
          default: all
        - name: triggered
          in: query
          schema:
          type: boolean
          nullable: true
           
      responses:
        '200':
          description: Alerts for the user
          content:
            application/json:
              schema:
            $ref: '#/components/schemas/AlertsResponse'
        '401':
          description: Authentication required
        '500':
          description: Failed to load alerts
    post:
      tags:
        - Alerts
      summary: Create a price drop alert
      description: Creates an alert tied to the authenticated RapidAPI user.
      operationId: createAlert
      security:
        - RapidAPIKey: []
          RapidAPIHost: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AlertCreateRequest'
            examples:
              trackByUrl:
                summary: Create alert for tracked URL
                value:
                  product_url: https://www.ebay.com/itm/1234567890
                  target_price: 249.99
                  notification_channels: [email, webhook]
                  email: shopper@example.com
                  webhook_url: https://example.com/price-drop
      responses:
        '201':
          description: Alert created
          content:
            application/json:
              schema:
            $ref: '#/components/schemas/AlertMutationResponse'
        '400':
          description: Validation failure
        '401':
          description: Authentication required
        '503':
          description: Upstream database unavailable
    put:
      tags:
        - Alerts
      summary: Update an existing alert
      description: Modify alert configuration using its `alert_id` query parameter.
      operationId: updateAlert
      security:
        - RapidAPIKey: []
          RapidAPIHost: []
      parameters:
        - name: alert_id
          in: query
          required: true
          schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                target_price:
                  type: number
                notification_channels:
                  type: array
                  items:
                    type: string
                status:
                  type: string
                email:
                  type: string
                webhook_url:
                  type: string
        '200':
          description: Alert updated
          content:
            application/json:
              schema:
              $ref: '#/components/schemas/AlertMutationResponse'
        '400':
          description: Alert identifier missing from the request
          content:
            application/json:
              example:
                success: false
                error: Alert ID is required
        '404':
          description: Alert not found
    delete:
      tags:
        - Alerts
      summary: Delete an alert
      description: Deletes an alert belonging to the authenticated user.
      operationId: deleteAlert
      security:
        - RapidAPIKey: []
          RapidAPIHost: []
      parameters:
        - name: alert_id
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Alert deleted
          content:
            application/json:
                schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '400':
                    description: Missing alert ID
        '401':
          description: Authentication required
        '403':
          description: Forbidden
        '404':
          description: Alert not found
  /api/v1/prices/check:
    post:
      tags:
        - Prices
      summary: Trigger scheduled price checks
      description: Invoked by Vercel Cron, GitHub Actions, or other automation to refresh tracked product prices and dispatch alerts. Requires the cron bearer token.
      operationId: runPriceCheck
      security:
        - CronBearer: []
      requestBody:
        required: false
      responses:
        '200':
          description: Price check results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CronCheckResponse'
        '401':
          description: Unauthorized
        '500':
          description: Price check failed
  /api/v1/affiliate/generate:
    post:
      tags:
        - Affiliate
      summary: Generate affiliate links
      description: Returns affiliate URLs for the supplied links (currently Amazon support).
      operationId: generateAffiliateLinks
      security:
        - RapidAPIKey: []
          RapidAPIHost: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AffiliateGenerateRequest'
            examples:
              amazon:
                summary: Generate Amazon affiliate URLs
                value:
                  urls:
                    - https://www.amazon.com/dp/B0C7SG3B8G
                  platform: amazon
      responses:
        '200':
          description: Affiliate links response
          content:
            application/json:
                           schema:
            $ref: '#/components/schemas/AffiliateGenerateResponse'
        '400':
          description: Invalid request body

